# 用户
type User {
  id: ID! @unique 
  createdAt: DateTime! 
  updatedAt: DateTime!
  userId: String! @unique
  password: String!
  status: Int! @default(value: "0")
  level: Int! @default(value: "0")
  name: String! 
  photo: String @default(value: "")
  email: String @default(value: "")
  desc: String @default(value: "")
  integral: Int! @default(value: "0")
  coin: Int! @default(value: "0")
  defaultUserGroup: String @default(value: "")
  defaultUserGroupId: String @default(value: "")
  privilegeBlack: Int! @default(value: "0")
  privilegeWhite: Int! @default(value: "0")
  privilegeGroup: [PrivilegeGroup!]!
  UserDiscuss: [Discuss!]! @relation(name: "DiscussByUser")
  UserDiscussChilder: [DiscussChilder!]! @relation(name: "DiscussChilderByUser")
  userGroup: [UserGroup!]! @relation(name: "UserGroupByUser")
  createUserGroup: [UserGroup!]! @relation(name: "CreateUserGroupByUser") 
  privilegeUserGroup: [UserGroup!]! @relation(name: "CrivilegeUserGroupByUser") 
  applyUserGroup: [UserGroup!]! @relation(name: "ApplyUsersByUser")
  problems: [Json!]!
  createProblmes: [Problem] @relation(name: "ProblemByUser")
  submitRecord: [Submit] @relation(name: "SubmitRecordByUser")
  submit: Int! @default(value: "0")
  solved: Int! @default(value: "0")
  accepted: Int! @default(value: "0")
}

# 权限组
type PrivilegeGroup {
  id: ID! @unique 
  createdAt: DateTime! 
  updatedAt: DateTime!
  name: String!
  privilege: Int!
  users: [User!]!
}

# 用户组
type UserGroup {
  id: ID! @unique
  createdAt: DateTime!
  updatedAt: DateTime!
  name: String!
  desc: String @default(value: "")
  count: Int! @default(value: "1")
  createUserId: String!
  createUserName: String!
  createUser: User! @relation(name: "CreateUserGroupByUser")
  privilege: [User!]! @relation(name: "PrivilegeUserGroupByUser")
  users: [User!]! @relation(name: "UserGroupByUser")
  applyUsers: [User!]! @relation(name: "ApplyUsersByUser")
}

# 题目
type Problem {
  id: ID! @unique
  problemId: Int @default(value: "0")
  createdAt: DateTime!
  updatedAt: DateTime!
  status: Int! @default(value: "0")
  type: Int! @default(value: "0"),
  tags: Json!
  title: String!
  describe: String!
  inDescribe: String!
  outDescribe: String!
  inExample: String!
  outExample: String!
  integral: Int @default(value: "0")
  limitTime: Int!
  limitMemory: Int!
  createUser: User @relation(name: "ProblemByUser")
  hint: String @default(value: "")
  source: String @default(value: "")
  sourceId: String @default(value: "")
  example: String @default(value: "")
  discuss: [Discuss!]! @relation(name: "DiscussByProblem" onDelete: CASCADE)
}

# 讨论
type Discuss {
  id: ID! @unique 
  createdAt: DateTime! 
  updatedAt: DateTime!
  contentRaw: String!
  content: String!
  user: User @relation(name: "DiscussByUser")
  userId: Int!
  userName: String!
  # 评论回复 楼中楼形式
  children: [DiscussChilder!]! @relation(name: "DiscussByChildren" onDelete: CASCADE)
}

type DiscussChilder {
  id: ID! @unique 
  createdAt: DateTime! 
  updatedAt: DateTime!
  contentRaw: String!
  content: String!
  user: User @relation(name: "DiscussChilderByUser")
  userId: Int!
  userName: String!
  replyUserId: Int!
  replyUserName: String!
}

type Submit {
  id: ID! @unique 
  createdAt: DateTime! 
  updatedAt: DateTime!
  user: User @relation(name: "SubmitRecordByUser")
  userId: Int!
  userName: String!
  problem: Problem!
  problemId: String!
  problemTitle: String!
  language: Int!
  code: String!
  result: String!
  errorInfo: String @default(value: "")
  contest: Contest 
  limitTime: Int!
  limitMemory: Int!
  time: Int!
  memory: Int!
}

type Contest {
  id: ID! @unique 
  createdAt: DateTime! 
  updatedAt: DateTime!
  name: String!
  type: Int
  createUserName: String!
  createUserId: Int!
  startTime: DateTime!
  endTime: DateTime!
  userGroup: UserGroup!
  contestProblem: ContestProblem! @relation(name: "ContsetByProblem" onDelete: CASCADE)
}

type ContestProblem {
  id: ID! @unique 
  createdAt: DateTime! 
  updatedAt: DateTime!
  problem: Problem
  problemId: String!
  problemTitle: String!
  ac: Int! @default(value: "0")
  wa: Int! @default(value: "0")
}